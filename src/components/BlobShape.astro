---
interface Props {
  color?: string;
  size?: string | number;
  shape?: 'shape-1' | 'shape-2' | 'shape-3' | 'shape-4';
  title?: string;
  className?: string;
  applyBlur?: boolean;
}

const {
  color = '#6C5CE7',
  size = 160,
  shape = 'shape-1',
  title = 'Blob shape',
  className = '',
  applyBlur = false
} = Astro.props as Props;

const sizeAttr = typeof size === 'number' ? `${size}` : size;
const viewBox = '0 0 200 200';

/* Rutas SVG para 4 blobs distintos */
const paths: Record<string, string> = {
  'shape-1': 'M44.8,-62.3C57.0,-53.6,65.9,-41.0,68.8,-27.5C71.7,-13.9,68.6,0.6,63.2,14.7C57.8,28.7,50.1,42.3,38.8,50.9C27.5,59.5,12.8,63.0,-1.0,64.1C-14.7,65.2,-29.5,63.9,-42.2,56.6C-54.9,49.2,-65.6,35.8,-69.2,20.7C-72.8,5.6,-69.4,-11.2,-61.7,-25.3C-53.9,-39.3,-41.7,-50.6,-28.0,-58.6C-14.3,-66.6,0.8,-71.3,15.2,-70.3C29.6,-69.2,44.8,-62.3,44.8,-62.3Z',
  'shape-2': 'M38.6,-55.6C51.6,-46.4,63.1,-35,66.3,-21.6C69.4,-8.2,64.2,7.3,57.0,21.8C49.7,36.3,40.3,49.8,27.1,59.3C13.8,68.8,-2.2,74.3,-16.8,70.6C-31.4,66.9,-44.6,53.9,-55.0,39.3C-65.4,24.6,-73.1,8.3,-71.1,-7.4C-69.1,-23.2,-57.4,-38.3,-43.2,-47.4C-29.0,-56.5,-14.5,-59.6,-0.2,-59.2C14.1,-58.8,28.2,-54.8,38.6,-55.6Z',
  'shape-3': 'M35.7,-61.1C49.1,-54.1,62.2,-46.0,69.0,-34.7C75.9,-23.4,76.5,-8.9,74.0,6.0C71.6,21.0,66.1,35.5,55.5,46.8C44.9,58.2,29.2,66.3,13.0,71.5C-3.2,76.7,-19.7,79.1,-34.5,74.1C-49.3,69.0,-62.3,56.6,-68.3,41.7C-74.2,26.8,-73.1,9.4,-69.0,-6.1C-64.9,-21.6,-57.8,-35.0,-46.6,-44.9C-35.4,-54.7,-20.1,-61.1,-4.1,-57.2C11.9,-53.4,23.9,-39.5,35.7,-61.1Z',
  'shape-4': 'M44.9,-57.6C55.6,-47.8,59.6,-33.4,63.2,-19.0C66.8,-4.7,70.0,9.6,66.1,22.5C62.1,35.5,51.1,46.9,38.2,55.7C25.3,64.6,10.4,70.9,-3.6,76.0C-17.6,81.1,-35.2,85.0,-46.4,78.0C-57.6,71.0,-62.4,53.2,-66.6,37.7C-70.8,22.2,-74.4,8.9,-76.6,-6.4C-78.8,-21.8,-79.6,-39.6,-69.6,-51.4C-59.6,-63.2,-38.9,-69.0,-20.0,-70.5C-1.0,-72.0,16.9,-69.0,44.9,-57.6Z'
};

/* Normalizamos la ruta para usar un viewBox centrado (las rutas están basadas en coordenadas centradas en 0)
   Usamos <g transform="translate(100,100) scale(0.9)"> para centrar dentro de 0..200 */
const selectedPath = paths[shape] ?? paths['shape-1'];
// Generar un id único para el filtro para evitar colisiones si hay varios blobs en la misma página
const filterId = `blob-blur-${Math.random().toString(36).slice(2,9)}`;
---
<!-- Componente BlobShape. Props: color, size, shape (shape-1..shape-4) -->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width={sizeAttr}
  height={sizeAttr}
  viewBox={viewBox}
  role="img"
  aria-label={title}
  preserveAspectRatio="xMidYMid meet"
  class={className}
>
  <title>{title}</title>
  <defs>
    <filter id={filterId} x="-20%" y="-20%" width="140%" height="140%" filterUnits="objectBoundingBox">
      <feGaussianBlur stdDeviation="3" />
      <feColorMatrix type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0" result="color"/>
    </filter>
  </defs>
  <g transform="translate(100 100) scale(1.4)">
    <path d={selectedPath} fill={color} style={applyBlur ? 'filter: blur(40px);' : undefined} />
  </g>
</svg>